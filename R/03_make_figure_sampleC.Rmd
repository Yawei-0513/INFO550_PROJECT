```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

Select one sample A, one sample B, one sample C and one sample D.Then simulate their read counts by Binom(n,0.5), Binom(n,0.25),Binom(n,0.125),Binom(n,0.05),Binom(n,0.01) and get a new dataset. Use upper quantile, median, quantile, TMM, Deseq and new method to do normalization.  Then calculate the spearman correlation with TaqMan qRT-PCR data and get results. At last, make barplots to compare the performance of different normalization methods. 





```{r, load-package}
library(ggplot2)
library(dplyr)
library(tidyr)
```

```{r}
sampleA<-read.csv("../data/sampleA.csv")
sampleB<-read.csv("../data/sampleB.csv")
sampleC<-read.csv("../data/sampleC.csv")
sampleD<-read.csv("../data/sampleD.csv")
```

```{r 03_make_figure_sampleC}
knitr::opts_chunk$set(echo = TRUE)
png("../figs/03_make_figure_sampleC.png")
gathercol<-names(sampleC)[-1]
c<-sampleC %>% gather(pc,measurment,gathercol)
c$measurment<-as.numeric(c$measurment)
pc<-ggplot(data = c,aes(pc,measurment,fill=method)) 
pcc<-pc+geom_bar(stat="identity", position=position_dodge()) + 
  scale_y_continuous(limits=c(0,0.88),breaks=seq(0.32,0.88,0.01))+labs(title = "sampleC")+coord_cartesian(ylim=c(0.71,0.85))
pcc
dev.off()
```